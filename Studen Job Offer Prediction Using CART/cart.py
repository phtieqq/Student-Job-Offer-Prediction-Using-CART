# -*- coding: utf-8 -*-
"""CART

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1bRJGm68f-Pdxm8QRRuNQNbF-h5lVfd20
"""

import pandas as pd
import matplotlib.pyplot as plt
from sklearn.tree import DecisionTreeClassifier, plot_tree

# Đọc dữ liệu từ file CSV
df = pd.read_csv('GPA.csv')

# Chuẩn hóa tên cột (xóa khoảng trắng thừa)
df.columns = df.columns.str.strip()

# Mã hóa dữ liệu
df_encoded = df.copy()
df_encoded['CGPA'] = df['CGPA'].map({'<8': 0, '>=8': 1, '>=9': 2})
df_encoded['Inter active'] = df['Inter active'].map({'No': 0, 'Yes': 1})
df_encoded['Practical Knowledge'] = df['Practical Knowledge'].map({'Average': 0, 'Good': 1, 'Very good': 2})
df_encoded['Comm Skills'] = df['Comm Skills'].map({'Poor': 0, 'Moderate': 1, 'Good': 2})
df_encoded['Job Offer'] = df['Job Offer'].map({'No': 0, 'Yes': 1})

# Tách features và target
features = ['CGPA', 'Inter active', 'Practical Knowledge', 'Comm Skills']
X = df_encoded[features]
y = df_encoded['Job Offer']

# Huấn luyện Decision Tree
dtree = DecisionTreeClassifier(criterion='gini', random_state=42)
dtree.fit(X, y)

# Vẽ cây quyết định
plt.figure(figsize=(20, 12))
plot_tree(
    dtree,
    feature_names=features,
    class_names=['No', 'Yes'],
    filled=True,
    rounded=True,
    fontsize=12,
    proportion=False,
    impurity=True
)
plt.title('CART - Decision Tree for Job Offer Prediction (Gini Impurity)',
          fontsize=18, fontweight='bold', pad=20)
plt.tight_layout()
plt.show()